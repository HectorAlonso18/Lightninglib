"use strict";(self.webpackChunklightning_docs=self.webpackChunklightning_docs||[]).push([[8408],{1055:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>o});var n=a(4848),t=a(8453);const r={sidebar_label:"How to create a FeedForward",sidebar_position:6},l="Introduction",i={id:"Tutorials/How_to_create_Feed_Forward",title:"Introduction",description:"A feedforward control system improves system performance by taking preemptive action based on known or anticipated disturbances",source:"@site/docs/Tutorials/How_to_create_Feed_Forward.md",sourceDirName:"Tutorials",slug:"/Tutorials/How_to_create_Feed_Forward",permalink:"/Lightninglib/docs/Tutorials/How_to_create_Feed_Forward",draft:!1,unlisted:!1,editUrl:"https://github.com/HectorAlonso18/Lightninglib/tree/main/docs/Tutorials/How_to_create_Feed_Forward.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_label:"How to create a FeedForward",sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"How to create a PID",permalink:"/Lightninglib/docs/Tutorials/How_to_create_PID_controllers"},next:{title:"Using Trapezoidal profilers",permalink:"/Lightninglib/docs/Tutorials/Using_Trapezoidal_profilers"}},c={},o=[{value:"Creating a FeedForward controller",id:"creating-a-feedforward-controller",level:2},{value:"Creating the motion function",id:"creating-the-motion-function",level:2},{value:"FeedForward Tuning",id:"feedforward-tuning",level:2},{value:"Congratulations! \ud83e\udd73",id:"congratulations-",level:2}];function m(e){const s={a:"a",admonition:"admonition",annotation:"annotation",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",hr:"hr",math:"math",mi:"mi",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["A feedforward control system improves system performance by taking preemptive action based on known or anticipated disturbances\r\nrather than reacting to the system's output. It directly manipulates the system's input based on a model or prediction of how  disturbances will impact the output ( ",(0,n.jsx)(s.a,{href:"https://resources.pcb.cadence.com/blog/2023-feedforward-control-system",children:"Cadence PCB Resources"})," )."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["The FeedForward implementation in lightning is based on ",(0,n.jsx)(s.strong,{children:"The Permanent-Magned DC Motor Feedforward Equation"}),", To se more information about the equation , refer to the article written by ",(0,n.jsx)(s.a,{href:"https://resources.pcb.cadence.com/blog/2023-feedforward-control-system",children:"WPILib"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"The Permanent-Magned DC Motor Feedforward Equation is"}),":"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.span,{className:"katex",children:[(0,n.jsx)(s.span,{className:"katex-mathml",children:(0,n.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(s.semantics,{children:[(0,n.jsxs)(s.mrow,{children:[(0,n.jsx)(s.mi,{children:"V"}),(0,n.jsx)(s.mi,{children:"o"}),(0,n.jsx)(s.mi,{children:"l"}),(0,n.jsx)(s.mi,{children:"t"}),(0,n.jsx)(s.mi,{children:"a"}),(0,n.jsx)(s.mi,{children:"g"}),(0,n.jsx)(s.mi,{children:"e"}),(0,n.jsx)(s.mo,{children:"="}),(0,n.jsxs)(s.msub,{children:[(0,n.jsx)(s.mi,{children:"K"}),(0,n.jsx)(s.mi,{children:"s"})]}),(0,n.jsx)(s.mo,{children:"\u2217"}),(0,n.jsx)(s.mi,{children:"s"}),(0,n.jsx)(s.mi,{children:"g"}),(0,n.jsx)(s.mi,{children:"n"}),(0,n.jsx)(s.mo,{stretchy:"false",children:"("}),(0,n.jsxs)(s.mover,{accent:"true",children:[(0,n.jsx)(s.mi,{children:"d"}),(0,n.jsx)(s.mo,{children:"\u02d9"})]}),(0,n.jsx)(s.mo,{stretchy:"false",children:")"}),(0,n.jsx)(s.mo,{children:"+"}),(0,n.jsxs)(s.msub,{children:[(0,n.jsx)(s.mi,{children:"K"}),(0,n.jsx)(s.mi,{children:"v"})]}),(0,n.jsx)(s.mo,{children:"\u2217"}),(0,n.jsxs)(s.mover,{accent:"true",children:[(0,n.jsx)(s.mi,{children:"d"}),(0,n.jsx)(s.mo,{children:"\u02d9"})]}),(0,n.jsx)(s.mo,{children:"+"}),(0,n.jsxs)(s.msub,{children:[(0,n.jsx)(s.mi,{children:"K"}),(0,n.jsx)(s.mi,{children:"a"})]}),(0,n.jsx)(s.mo,{children:"\u2217"}),(0,n.jsxs)(s.mover,{accent:"true",children:[(0,n.jsx)(s.mi,{children:"d"}),(0,n.jsx)(s.mo,{children:"\xa8"})]})]}),(0,n.jsx)(s.annotation,{encoding:"application/x-tex",children:"Voltage = K_s * sgn(\\dot{d}) + K_v * \\dot{d} + K_a * \\ddot{d}"})]})})}),(0,n.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"lt"}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"a"}),(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(s.span,{className:"mrel",children:"="}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(s.span,{className:"mord",children:[(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,n.jsx)(s.span,{className:"msupsub",children:(0,n.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(s.span,{className:"vlist-r",children:[(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(s.span,{className:"mord mathnormal mtight",children:"s"})})]})}),(0,n.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(s.span,{})})})]})})]}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(s.span,{className:"mbin",children:"\u2217"}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"1.1813em",verticalAlign:"-0.25em"}}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,n.jsx)(s.span,{className:"mopen",children:"("}),(0,n.jsx)(s.span,{className:"mord accent",children:(0,n.jsx)(s.span,{className:"vlist-t",children:(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsxs)(s.span,{className:"vlist",style:{height:"0.9313em"},children:[(0,n.jsxs)(s.span,{style:{top:"-3em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"d"})]}),(0,n.jsxs)(s.span,{style:{top:"-3.2634em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(s.span,{className:"accent-body",style:{left:"0.0278em"},children:(0,n.jsx)(s.span,{className:"mord",children:"\u02d9"})})]})]})})})}),(0,n.jsx)(s.span,{className:"mclose",children:")"}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(s.span,{className:"mbin",children:"+"}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(s.span,{className:"mord",children:[(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,n.jsx)(s.span,{className:"msupsub",children:(0,n.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(s.span,{className:"vlist-r",children:[(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"v"})})]})}),(0,n.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(s.span,{})})})]})})]}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(s.span,{className:"mbin",children:"\u2217"}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"1.0146em",verticalAlign:"-0.0833em"}}),(0,n.jsx)(s.span,{className:"mord accent",children:(0,n.jsx)(s.span,{className:"vlist-t",children:(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsxs)(s.span,{className:"vlist",style:{height:"0.9313em"},children:[(0,n.jsxs)(s.span,{style:{top:"-3em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"d"})]}),(0,n.jsxs)(s.span,{style:{top:"-3.2634em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(s.span,{className:"accent-body",style:{left:"0.0278em"},children:(0,n.jsx)(s.span,{className:"mord",children:"\u02d9"})})]})]})})})}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(s.span,{className:"mbin",children:"+"}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,n.jsxs)(s.span,{className:"mord",children:[(0,n.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,n.jsx)(s.span,{className:"msupsub",children:(0,n.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(s.span,{className:"vlist-r",children:[(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(s.span,{className:"mord mathnormal mtight",children:"a"})})]})}),(0,n.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(s.span,{})})})]})})]}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(s.span,{className:"mbin",children:"\u2217"}),(0,n.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(s.span,{className:"base",children:[(0,n.jsx)(s.span,{className:"strut",style:{height:"0.9313em"}}),(0,n.jsx)(s.span,{className:"mord accent",children:(0,n.jsx)(s.span,{className:"vlist-t",children:(0,n.jsx)(s.span,{className:"vlist-r",children:(0,n.jsxs)(s.span,{className:"vlist",style:{height:"0.9313em"},children:[(0,n.jsxs)(s.span,{style:{top:"-3em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(s.span,{className:"mord mathnormal",children:"d"})]}),(0,n.jsxs)(s.span,{style:{top:"-3.2634em"},children:[(0,n.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,n.jsx)(s.span,{className:"accent-body",style:{left:"-0.0833em"},children:(0,n.jsx)(s.span,{className:"mord",children:"\xa8"})})]})]})})})})]})]})]})}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsxs)(s.p,{children:["During the ",(0,n.jsx)(s.a,{href:"https://www.youtube.com/watch?v=wIZgvVDZc2Y&t=89s&pp=ygUZc3BpbiB1cCBzZWFzb24gZ2FtZSB2aWRlbw%3D%3D",children:"SPIN-UP"})," season our team ",(0,n.jsx)(s.code,{children:"ITESM1"})," used a PID combined with a FeedForward Controller to control the Flywheel Velocity. The results were amazing, providing incredible control over the flywheel velocity and increasing the shooting accurancy. To see this in action, check out this ",(0,n.jsx)(s.a,{href:"https://www.youtube.com/watch?v=_u5JN3hauW0",children:"Video"}),"."]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h1,{id:"feedforward-tutorial",children:"FeedForward Tutorial"}),"\n",(0,n.jsx)(s.h2,{id:"creating-a-feedforward-controller",children:"Creating a FeedForward controller"}),"\n",(0,n.jsxs)(s.p,{children:["Creating a FeedForward controller is matter of using the constructor for the ",(0,n.jsx)(s.code,{children:"FeedForward"})," class.\r\nCheck the ",(0,n.jsx)(s.a,{href:"/docs/Documentation/Feed_Forward",children:"FeedForward Documentation"})," for more information about it."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-cpp",metastring:'title="main.cpp"',children:"lightning::FeedForward speed_controller (\r\n    5, // The velocity constant.\r\n    1000, // The Friction constant.\r\n    350); //Acceleration constant.\n"})}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"creating-the-motion-function",children:"Creating the motion function"}),"\n",(0,n.jsx)(s.p,{children:"In the next code we would create a function with the objetive of controlling the velocity on a flywheel using a feedforward controller."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-cpp",metastring:'title= "main.cpp"',children:"lightning::FeedForward speed_controller (\r\n    5, // The velocity constant.\r\n    1000, // The Friction constant.\r\n    350); //Acceleration constant.\r\n\r\nvoid move_flywheel(int RPM){\r\n    float velocity=0; \r\n    while(1){\r\n        velocity = get_flywheel_velocity(); \r\n        controller.update(velocity);\r\n        flywheel.move_voltage(speed_controller.get_output()); \r\n    }\r\n}\n"})}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"feedforward-tuning",children:"FeedForward Tuning"}),"\n",(0,n.jsxs)(s.p,{children:["Tuning the feedforward controller is necessary for accurate results. For a comprehensive guide on how to tune your feedforward controller, We recommend the following ",(0,n.jsx)(s.a,{href:"https://learnroadrunner.com/feedforward-tuning.html#tuning",children:"guide"}),"."]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"congratulations-",children:"Congratulations! \ud83e\udd73"}),"\n",(0,n.jsxs)(s.p,{children:["You finished the ",(0,n.jsx)(s.code,{children:"FeedForward"})," tutorial, now you are able to create and use a ",(0,n.jsx)(s.code,{children:"FeedForward"})," controller for your routines."]}),"\n",(0,n.jsx)(s.admonition,{type:"tip",children:(0,n.jsxs)(s.p,{children:["You can combined the ",(0,n.jsx)(s.code,{children:"FeedForward"})," controller with a ",(0,n.jsx)(s.code,{children:"PID"})," controller, having a ",(0,n.jsx)(s.strong,{children:"FeedForward FeedBack controller"}),", feel free to experiment \ud83e\uddea."]})})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(m,{...e})}):m(e)}},8453:(e,s,a)=>{a.d(s,{R:()=>l,x:()=>i});var n=a(6540);const t={},r=n.createContext(t);function l(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);